<p align="center">
  <img src="./images/cyber_ariel.png" width="400"/>
</p>

<p align="center">


[<img alt="Ariel University Home" src="https://img.shields.io/badge/Ariel%20University-blue?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABUAQMAAAAmpYKCAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAGUExURQsUK/7//yyPHFQAAADqSURBVCjPbdCxkYRADETRT2FgshmQwmVASpfBTmiEQggyMSj6jEFCKs573u9qYJIkA4Ax3Bgk6QDYQJJOgL36K+kCMFglCeCARZIacFbPkrQB1x3eAaWwWnGMUBqhFJZV+wilEUrh4jRCaYRSuPoZoTRCKVz9jFAKK4WrnxGKsKEIv3yPMBRhQxF++R5hKMKGIvx2H9Hdw909/HYf0d3D5pdlz+4+oruHbzeGf731jxXh21a9ug9Y3CfM7qt6cgvGcGMIb8WEd/i6DVb3Ub24T5jdF0xuVY/hxhDeILxX/7oNftwHfNwnfP4ALPV3tucoteYAAAAASUVORK5CYII=" />](https://www.ariel.ac.il/)
[<img alt="ACIC Home" src="https://img.shields.io/badge/Ariel%20Cyber%20Innovation%20Center%20-blue?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABaBAMAAABEXBVNAAAAGFBMVEXj9/kKFTis2uCBv8ZXsLN73eA+Rl4Rpq9f4ewTAAAAB3RSTlMB/UmY4eXFFy+TWQAABOpJREFUWMOtmEFv2zoMxw3lofe0QM56sl97zSQlvg6xDN8XG7kuKbAPUMvQ1x8pybbsyE42PJ261T+R/JOiqCZJdKVSwTqKozwehRBH8Vl8ws/w4z5ZXdft0npd5V62y2sV/HcF/LnCEfD0V3xtt28r4PvyvrDlfs3gji7vufQ7kl7XtMMo2NKeywbdr7d0SdHbigCgTzzMb9vtJ30g+S0exBtdTTKQr/H/dvsRIUWwzuIgBPU+xXJJ+ghSc7f03quwi4CbXrP8HjQnL2xM9RcPgsFmuoQwmoafzPNktyOV6WYgZ5UpaBjNLI0YQKqMbuouWLrTp9RoJJfAVxdg11RzbcCk2VvwFss/guhofacNTyvUZ8jYNP+7G0aomzuDYJKm5mvYPFocpjtUkXQUrGpXwY3pYmkEZyttdZiWTootUXH46R9TXBZAQweQ+WwSVauyrBX8MzNlHPz6QFnfbcqkzQ2srGiErJu6SJIP08TBNhtAKBHDrWElCzgFsgFnc9NUS+B3X3OZFlXLUyBKRZ3DRQrZiHKms+DGgSzXKEqJPlqPparMAqhtIi34UbDclbNyBUgkTxv9GMxAB2tRnfqsCAkFFwcNM60HN6DCiTJYY0KZ6eoFUCBI7IGUqqD3FReCKvj5PIJEBLbofcVpzrIoGFryfWwCnib952x0BISdC9dvyvHTva3dVZDkugLHGPvPdHI8g9aFAaxioIGasZkJDkdny+kBWHFSNc350IQxTi2WVRsFmbEWq3YJbDDGzR2opRYsFYfQ4g+nWg9WrnKSmaq2pYCqAVi4ozdYtODs8tgoxXzlyKC1BZ468OXu1vEFSyZFvg/SqC34PoJE8GmwAUgD0BzwWI1djsj+7vMgfBAFtcQSDMDK1iRNiJUZ7ojzAmhbx9iQM839aXYLz11UHBDtO44JA9iyrBOC9xd+czldoiAUBg0vHQQNtMfCdi2lLuaUB8XKxqRiJw/uR+yRGqYMmIsldATwtf0YQM7S6d2xGcGhK9seQMCEHj+G0g2anMv/UKpZNWk8sBGLdscMxQ/ynxA2nQgvhueLd058QMI9WArqZLE5B0VNojc5jKv2QJqvNNaO/fn/6Tt3GB5TeBtAd0/v76vWXgD9fESUCYQhsmzqWsqL+XEfZJG5SnWiwuk12NrcEqpRWDsSt59rClkMtPlQB2xttS0Zpbr65I6kHYfmnrZ0GI9IfmKXsq7rpqztbef8Jrnhcq6pPVND3SAYzHuK9/1n7msHZUnHEJMcTntZYIFLWP0UjF1gZrKQVsVrn/7MaO3EIYTQUd8c+/pUGqznzTABQjTF/NJKKTbhqUmYAJ2nQzNmjM7n+eur2zAwCWOcvfGu0YF88raCsZaPPYtLa/Bl9TXjXnNgsmW9s+fURojPmZVXCXGvRDiVBbt4R52kZP39iPviCA2C8xRHB7Ss+frLsn9DvPk+jWTJ/SVP1qQJH6YwBHWMQbeqsEqtwfVXOX7x5p8tmhHg7CiAD7n1B5v9ZO8HEbgvXIBPGLQFsvPXkek5sn1o0H1060nHJcf1p+worD8+acEfPcjnUb499cSNPCTDD8m3B0UzfbjzyV8O9s+B6NuOB7vckifX5joKhBHTZ0H3Rwjuud3znM0ckOy4DZx+LkyL4B8ptn/EefIvuJ7c/TEH5Pvfcdg+P1nyP67fYb4noeL/R5wAAAAASUVORK5CYII=" />](https://www.ariel-cyber.co.il/)

</p>

<h1 align="center">ITC Data Augmentation </h1>

## Table of Contents
- [Goal](#goal)
- [Repository](#repository)
- [Code](#code)
- [Data](#data)
- [Data converter](#data-converter)
- [Dependencies](#dependencies)


## Goal
<p align="center">
    Internet Traffic Classification (ITC) is a vital research area in the era of increasing
online services. However, the evolution of internet protocols and encryption methods
poses challenges for the classification of encrypted Internet traffic. One of the main
challenges is the lack of open-source datasets and the shortcomings of existing ones.
This thesis tackles this challenge by proposing 3 data augmentation techniques: LSTM,
Average, and MTU, which have different advantages and drawbacks.
</p>

## Repository 

This repository consist of 4 directories:
* code - contains the scripts for the project
* data - provides sample data from open source
* data converter - includes code to transform the data to the required format
* images - stores the images used in the README file

## Code

### How to Run the Code

**To run the code provided in this project, you need to run the `Main.py` file with the following arguments:**

**Required arguments:**

* `data_dir`: The directory containing the training data.
* `augmentation`: The augmentation method to use. Supported values are `lstm`, `average`, and `mtu`.

**Optional arguments:**

* `--test_split`: The fraction of the data to use for the test set. **Default** is 0.2.
* `--val_split`: The fraction of the data to use for the validation set. **Default** is 0.2.
* `--batch_size`: The batch size to use for training. **Default** is 32.
* `--split`: The split of the flow. **Default** is 16.
* `--max_len`: The maximum length of a flow. **Default** is 32.
* `--data_max_size`: The maximum number of data points to use. **Default** is -1 (use all data points).
* `--avg_n`: The number of data points to average for the Average augmentation. **Default** is 2.
* `--th_min`: The minimum threshold for the MTU augmentation. **Default** is 750.
* `--th_max`: The maximum threshold for the MTU augmentation. **Default** is 1200.


### Example Usage

To train a model using the LSTM augmentation on the provided data, run the following command:

```
python Main.py ../data/  lstm
```

This will train a model using the default batch size (32) and data_max_size (-1). To use different values, specify them as command line arguments. For example, to train a model using a batch size of 64 and data_max_size of 100, run the following command:

```
python Main.py ../data/  lstm --batch_size 64 --data_max_size 100
```

### How to Run the Tests
**To run the tests provided in this project, you need to run the `Tests.py` file with the following arguments:**

**Required arguments:**

* `data_dir`: The directory containing the test data.
* `augmentation`: The augmentation method to test. Supported values are `lstm`, `average`, and `mtu`.

**Optional arguments:**

* `--split`: The split of the flow. **Default** is 16.
* `--max_len`: The maximum length of a flow. **Default** is 32.
* `--avg_n`: The number of data points to average for the Average augmentation. **Default** is 2.

### Example Usage

To test the LSTM augmentation generated model on the provided data, run the following command:

```
python Tests.py ../data/  lstm
```

## Data
In the paper we tested our data augmentation on three different datasets.

#### QUIC Paris:
* Extracted from: [Data]( https://drive.google.com/drive/folders/1cwHhzvaQbi-ap8yfrj2vHyPmUTQhaYOj)

* The data was generated by: Tong, V., Tran, H. A., Souihi, S., & Mellouk, A. (2018, December). A novel QUIC traffic classifier based on convolutional neural networks. In 2018 IEEE Global Communications Conference (GLOBECOM) (pp. 1-6). IEEE. [Article](https://ieeexplore.ieee.org/document/8647128)

#### QUIC Davis:
* Extracted from: [Data]( https://drive.google.com/drive/folders/1Pvev0hJ82usPh6dWDlz7Lv8L6h3JpWhE)
* The data was generated by: Rezaei, S., & Liu, X. (2018). How to achieve high classification accuracy with just a few labels: A semi-supervised approach using sampled packets. arXiv preprint arXiv:1812.09761. [Article](https://arxiv.org/abs/1812.09761)

#### Flash:
* consists of real-world data captured in 2023 and is a commercial dataset
* To request this dataset, please email me at [yehonata.zion@msmail.ariel.ac.il](mailto:yehonata.zion@msmail.ariel.ac.il).

## Data converter

This code is used to convert data to fit the code required format. The code was originally implemented by [FlowPic](https://github.com/talshapira/FlowPic), and has been modified to fit our specific needs.

For more details on the code, please visit the provided link.

## Dependencies
* keras>=2.13.1
* numpy>=1.24.3
* scikit_learn>=1.3.0
* tensorflow>=2.13.0

To install the required modules using pip:  
```
pip install -r requirements.txt
```


